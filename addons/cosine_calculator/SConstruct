#!/usr/bin/env python
import os
import sys

# 获取 godot-cpp 路径
godot_cpp_path = "../../godot-cpp"
if not os.path.exists(godot_cpp_path):
    print("错误: 找不到 godot-cpp，请确保它在项目根目录")
    sys.exit(1)

env = SConscript(godot_cpp_path + "/SConstruct")

# 添加源文件路径
env.Append(CPPPATH=["src/"])
sources = Glob("src/*.cpp")

# 构建共享库
if env["platform"] == "macos":
    library = env.SharedLibrary(
        "bin/libcosine_calculator.{}.{}.framework/libcosine_calculator.{}.{}".format(
            env["platform"], env["target"], env["platform"], env["target"]
        ),
        source=sources,
    )
else:
    library = env.SharedLibrary(
        "bin/libcosine_calculator{}{}".format(env["suffix"], env["SHLIBSUFFIX"]),
        source=sources,
    )

Default(library)
